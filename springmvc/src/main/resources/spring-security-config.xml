<?xml version="1.0" encoding="UTF-8"?>
<b:beans xmlns="http://www.springframework.org/schema/security"
         xmlns:b="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://www.springframework.org/schema/beans
                             http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
                             http://www.springframework.org/schema/security
                             http://www.springframework.org/schema/security/spring-security-4.1.xsd">

  <!-- 不需要进行安全认证的资源 -->
  <http pattern="/resources/**" security="none" />
  <http pattern="/index.jsp" security="none" />

  <!--auto-config设为false，才启用form-login-->
  <http use-expressions="true" auto-config="true">
    <form-login login-page="/index.jsp" login-processing-url="/login"
                default-target-url="/user.jsp"
                authentication-failure-url="/fail.jsp"
                username-parameter="username" password-parameter="password"/>
    <intercept-url pattern="/fail.jsp" access="permitAll" />
    <intercept-url pattern="/user.jsp" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
    <intercept-url pattern="/admin.jsp" access="hasAnyRole('ROLE_ADMIN')" />
    <!--禁用scrf-->
    <csrf disabled="true"/>
  </http>



  <!-- 认证管理器  默认为ProviderManager-->
  <authentication-manager alias="authenticationManager">
    <authentication-provider ref="provider"></authentication-provider>
  </authentication-manager>

  <b:bean class="ZzzAhu163.service.security.MyAuthenticationProvider" id="provider"></b:bean>
</b:beans>

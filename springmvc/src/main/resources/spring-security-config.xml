<?xml version="1.0" encoding="UTF-8"?>
<b:beans xmlns="http://www.springframework.org/schema/security"
         xmlns:b="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://www.springframework.org/schema/beans
                             http://www.springframework.org/schema/beans/spring-beans-4.1.xsd
                             http://www.springframework.org/schema/security
                             http://www.springframework.org/schema/security/spring-security-4.1.xsd">

<!-- 不需要进行安全认证的资源 -->
  <http pattern="/resources/**" security="none" />
  <!-- 资源所需要的权限 -->
  <http use-expressions="true" auto-config="true">
    <intercept-url pattern="/index.jsp*" access="permitAll" />
    <intercept-url pattern="/user.jsp*" access="hasRole('ROLE_USER')" />
    <intercept-url pattern="/admin.jsp*" access="hasRole('ROLE_ADMIN')" />
    <intercept-url pattern="/**" access="hasRole('ROLE_USER')" />
  </http>
  <!-- 认证管理器 -->
  <authentication-manager>
    <!--认证管理器使用provider进行认证-->
    <authentication-provider>
      <!--provider主要靠userService比对用户信息，做出决策-->
      <user-service>
        <user name="test" password="test" authorities="ROLE_USER" />
        <user name="admin" password="admin" authorities="ROLE_USER,ROLE_ADMIN" />
      </user-service>
    </authentication-provider>
  </authentication-manager>
</b:beans>
